#!/bin/bash
set -euo pipefail

{{ template "script_header.sh" . }}
{{ template "aqua_install.sh" . }}

cd {{ .chezmoi.sourceDir }}/dot_config/aquaproj-aqua

log_info "CLI Tools | Tags[prerequisites] | Initializing Aqua..."
if ! command -v aqua > /dev/null; then
  log_error "CLI Tools | Tags[prerequisites] | Aqua binary is not in path, cannot proceed!"
  exit 1
fi
log_info "CLI Tools | Tags[prerequisites] | Installing or upgrading aqua packages..."
aqua install --tags prerequisites 2>&1 | sed -E 's|^(.*)|  \1|g'
log_success "CLI Tools | Tags[prerequisites] | Aqua install is complete."
echo
log_info "CLI Tools | Tags[prerequisites] | Display installed packages..."
aqua list --installed --all | column -t 2>&1 | sed -E 's|^(.*)|  \1|g'  
echo "-------------------------------------------------------------------------------------------"
echo
